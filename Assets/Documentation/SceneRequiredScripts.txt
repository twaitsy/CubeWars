CubeWars - Required Scene Scripts Before Gameplay

Core bootstrap/system scripts (required)
- GameManager
- TeamStorageManager
- TeamResources
- DiplomacyManager
- BuildPlacementManager
- BuildGridManager
- ResourceRegistry
- CraftingSystem (legacy API support, optional if still crafting ToolItem assets)
- JobManager
- CraftingJobManager
- ProductionNotificationManager
- ProjectilePool

Common global managers (recommended / used by existing systems)
- SaveLoadManager
- EventManager
- AIManager
- UnitManager
- CombatManager
- TeamColorManager
- WinConditionManager

Production-chain building scripts (required if using crafting economy)
- BuildingInteractionSettings (attach to building prefabs to configure civilian stop distances)
- BuildingPrefabValidator (optional prefab self-check logger for missing required components)
- CraftingBuilding
- ProductionStatusVisualizer (optional but recommended for missing-input/full-output icons)

UI/interaction scripts
- SelectionManager
- UnitInspectorUI
- EconomyUI
- BuildMenuUI
- Minimap
- IMGUIInputBlocker
- TaskBoardUI (if using civilian role/task management UI)

Scene camera/input scripts
- RTSCamera

Team setup scripts (at least one)
- TeamBootstrap OR SixTeamBootstrap OR HQSpawner

Notes
- DiplomacyManager should have "Initialize All Teams At War" enabled unless manually configured.
- BuildPlacementManager must have constructionSitePrefab assigned when useConstructionSites is true.
- Every combat unit prefab should include UnitCombatController and Attackable.
- Every civilian prefab should include Civilian + NavMeshAgent.
- ProjectilePool must exist so pooled projectiles are reused.
- Resource nodes require ResourceNode and rely on ResourceRegistry for discovery.

- Civilians assigned to crafting need matching CivilianJobType (Blacksmith, Carpenter, Farmer, Cook, Engineer) for recipe.requiredJobType.
- Crafting buildings should define inputSlot, outputSlot, workPoints[], throughput caps, and recipe batches for full logistics behavior.

RTS control/combat modernization additions
- SelectionManager (updated: drag-select, shift add/remove, contextual right-click command routing)
- UnitManager (updated: formation offset utility for group move spacing)
- UnitCombatController (updated: visionRange, behaviorState, attack-move handling, stance-aware auto-acquire)
- CombatManager (updated: default vision/combatant configuration)
- ProjectilePool + Projectile (updated: consistent pooled projectile motion/impact timing)
- Selectable (updated: selected + hover indicator support)
- UnitInspectorUI (updated: combat debug fields + robust HQ diplomacy panel lookup)
- MainMenuUI (updated: team/diplomacy match setup screen)

Prefab/component notes for updated behavior
- Combat unit prefab should include: Unit, Attackable, UnitCombatController, WeaponComponent, NavMeshAgent, Selectable.
- Civilian prefab should include: Civilian, NavMeshAgent, Selectable.
- Selectable can optionally reference:
  - selectionRing
  - hoverRing
  - attackRangeCircle
  - visionRangeCircle
- Attackable can optionally reference flashRenderer for damage flash feedback.

Needs/Housing additions
- House (required for civilian sleep recovery)
- FoodResourceDatabase asset assigned to Civilian prefab (recommended; script path: Assets/Data/DatabaseScripts/FoodResourceDatabase.cs)
- Civilian prefab uses hunger/tiredness fields for runtime survival

Editor productivity
- ResourceAuthoringWindow (Editor-only) for creating ResourceNode prefabs quickly

Startup placement/alignment requirements (new)
- BuildGridManager + BuildPlacementManager are required for centered multi-cell footprint placement.
- TeamBootstrap startingBuildings uses grid coordinates and footprint occupancy checks.
- Building prefabs that occupy multiple cells should include BuildingFootprint.
- See Assets/Documentation/BuildingFootprint.txt for full setup and rotation alignment guidance.

Recent behavior requirements
- CraftingBuilding.requireHaulerLogistics can enforce hauler-only transport for production input/output.
- Ensure at least one Civilian with role Hauler is available per production cluster when hauler logistics is enabled.

Storage/crafting logistics validation checklist (latest)
- ResourceStorageProvider must share a GameObject hierarchy with a ResourceStorageContainer so local capacities can be applied correctly.
- Do not rely on team-wide mirrored capacities for building-local inspector storage views.
- Ensure CraftingBuilding recipes only request resources that have actual storage capacity configured in scene setup.
- Keep at least one reachable storage with free capacity for each gathered/crafted resource type to avoid logistics stalls.


- BuildingPrefabValidator now warns about conflicting/not-required script combinations (for example: multiple production scripts on one prefab, ProductionStatusVisualizer without CraftingBuilding, ResourceStorageProvider without ResourceStorageContainer).
- Crafting logistics expectation: haulers should always stock crafting input buffers first, then move crafted outputs to external storage providers second.


- Crafting hauler assignment should not force Hauler -> Crafter role conversion; otherwise requireHaulerLogistics stalls.
- CraftingBuilding prefab hierarchies should contain exactly one ResourceStorageContainer to prevent local storage split/conflicts.
- BuildingPrefabValidator now warns when CraftingBuilding has multiple ResourceStorageContainer components in hierarchy.
Related documentation
- Crafting building prefab setup: Assets/Documentation/CraftingBuildingPrefabSetup.txt


Storage flow configuration requirements (new)
- ResourceStorageContainer now includes per-resource hauling flow controls in Inspector:
  - Disabled
  - ReceiveOnly
  - SupplyOnly
  - ReceiveAndSupply
- Configure these for every crafting/storage building so haulers know valid pickup/drop-off targets.
- UnitInspectorUI shows per-resource flow at runtime under the Storage tab.


- Simplified crafting role split:
  - Haulers perform crafting transport (input-in first, output-out second).
  - Other selected civilians (matching required job type) are expected to stay near crafting work points to keep production active.


Latest script requirements/additions
- WorldProgressBar (optional): attach to buildings/objects that need future world-space progress visualization (construction, upgrades, etc.).

Behavioral expectations to verify in scenes
- Crafting haulers should deliver up to their civilian carry capacity per trip when input buffers are missing resources.
- Idle civilians should show an assigned house in inspector when capacity exists; otherwise inspector should display "Homeless".
- Barracks and Turret should expose a demolish action from UnitInspectorUI Overview.
- TeamBootstrap-spawned HQ positions should align to BuildGridManager cell coordinates.

Latest required script links (Unified civilian jobs/tools update)
- CivilianJobRegistry (maps unified CivilianJobType into runtime work domains + legacy role compatibility)
- CivilianToolRegistry (defines job-specific and universal tools/bonuses)

Scene setup checks
- Ensure a TeamInventory exists in-scene for civilians to claim crafted tools.
- Ensure house prefabs that should store food include one ResourceStorageContainer (it will run as ReceiveOnly for hauler flow).
- Keep at least one non-house storage with Supply enabled for food so civilians can still retrieve food logistics when house stock is empty.


Latest crafting/needs runtime checks
- Civilian + CraftingBuilding pairing now expects valid NavMesh paths from civilian spawn areas to crafting work points; unreachable work points trigger stall recovery and assignment clear after ~10s.
- House prefabs that should serve nearby resident meals must include a ResourceStorageContainer with edible resources (ReceiveOnly flow is acceptable; residents bypass hauling flow checks when eating at home).
- Crafting production throughput depends on active workers physically present at site/workpoint, not just assigned worker count.

Database migration note
- TeamAIBuild now references BuildingsDatabase (Assets/Data/Databases/BuildingsDatabase.asset) for buildable item catalog data.
- BuildMenuUI now resolves build catalog data from BuildingsDatabase first (inspector ref -> GameDatabase.buildings -> editor fallback path Assets/Data/Databases/BuildingsDatabase.asset), then falls back to Resources path only if no database is available.
