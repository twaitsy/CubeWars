// ============================================================================
// BuildGridCell.cs
//
// PURPOSE:
// - Represents a single tile in the build grid.
// - Stores team ownership, world position, occupancy state, and placed object.
// - Handles click interaction for building placement.
//
// DEPENDENCIES:
// - BuildGridManager:
//      * Calls Init() to assign teamID, coordinates, and worldCenter.
//      * Calls OnCellClicked() when this cell is clicked.
// - BuildPlacementManager:
//      * Attempts to place buildings when a cell is clicked.
// - BuildCellReservation (optional):
//      * May be attached to the same GameObject to restrict placement.
// - BuildMenuUI:
//      * Syncs grid visibility with build menu visibility.
// - ConstructionSite / Building:
//      * When a building is placed, gridCell.placedObject is assigned.
// - EventSystem:
//      * Used to prevent clicks through UI.
//
// NOTES FOR FUTURE MAINTENANCE:
// - If you add multi-cell buildings, this class must support footprint metadata.
// - If you add terrain alignment, worldCenter should be adjusted to terrain height.
// - If you add drag-to-place or area selection, OnMouseDown may need expansion.
// - If you add fog-of-war, visibility logic should be integrated here.
// - If you add AI building logic, ensure AI respects teamID and occupancy.
//
// INSPECTOR REQUIREMENTS:
// - None; this component is created dynamically by BuildGridManager.
// ============================================================================

using UnityEngine;
using UnityEngine.EventSystems;

public class BuildGridCell : MonoBehaviour
{
    [HideInInspector] public int teamID;
    [HideInInspector] public Vector2Int gridCoord;
    [HideInInspector] public Vector3 worldCenter;

    private BuildGridManager manager;
    public bool isOccupied;
    public GameObject placedObject;

    public void Init(BuildGridManager mgr, int t, Vector2Int coord, Vector3 center)
    {
        manager = mgr;
        teamID = t;
        gridCoord = coord;
        worldCenter = center;
    }

    void OnMouseDown()
    {
        if (EventSystem.current != null && EventSystem.current.IsPointerOverGameObject())
            return;

        if (manager != null)
            manager.OnCellClicked(this);
    }
}