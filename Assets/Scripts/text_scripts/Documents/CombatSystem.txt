// ============================================================================
// CUBE WARS — COMBAT SYSTEM MASTER DOCUMENT
// ============================================================================
//
// This file documents the entire combat architecture of Cube Wars.
// It is NOT executable code. It exists to help developers and AI assistants
// understand how the combat system works, how to extend it, and what each
// GameObject requires in the Inspector.
//
// ============================================================================
// 1. OVERVIEW
// ============================================================================
//
// The combat system in Cube Wars is modular and component-based.
// It is built around four core pillars:
//
//   (A) Attackable              ? Universal health + damage component
//   (B) UnitCombatController    ? Targeting + stance logic
//   (C) WeaponComponent         ? Firing logic + cooldowns
//   (D) Projectile System       ? Projectile + ProjectilePool
//
// Units and Turrets both use the same WeaponComponent and Projectile system.
// The only difference is how they acquire targets.
//
// ============================================================================
// 2. REQUIRED COMPONENTS ON COMBAT UNITS
// ============================================================================
//
// Any GameObject that participates in combat MUST have:
//
//   • Attackable (MonoBehaviour)
//       - Exposes: teamID, IsAlive, TakeDamage(), isCivilian, isBuilding
//       - Allows other units to target and damage this object.
//
//   • UnitCombatController
//       - Handles target acquisition, stance logic, and firing requests.
//       - Requires a WeaponComponent.
//
//   • WeaponComponent
//       - Handles firing cooldowns, muzzle FX, projectile spawning.
//
//   • (Optional) NavMeshAgent
//       - Required for moving units (not needed for turrets).
//
//   • (Optional) Animator
//       - For future animation integration.
//
// Turrets additionally require:
//
//   • A static transform (no movement)
//   • A muzzle Transform for projectile spawn
//
// ============================================================================
// 3. HOW TO CREATE A NEW RANGED UNIT
// ============================================================================
//
// 1. Create a new prefab (e.g., "Archer", "Rifleman", "Mage").
// 2. Add the following components:
//
//      [REQUIRED]
//      - Unit (teamID, health, movement)
//      - Attackable (teamID, health interface)
//      - UnitCombatController (targeting + stance)
//      - WeaponComponent (damage, cooldown, range)
//      - ProjectilePool (must exist in scene ONCE)
//      - Projectile prefab (assigned in WeaponComponent)
//
//      [OPTIONAL]
//      - NavMeshAgent (for movement)
//      - Animator (for future animation hooks)
//
// 3. In WeaponComponent, assign:
//      - projectilePrefab
//      - muzzle Transform
//      - damage, range, fireCooldown
//
// 4. In UnitCombatController, assign:
//      - attackableLayers (layer mask for valid targets)
//
// 5. Add the unit to a UnitProductionDefinition if it should be trainable.
//
// ============================================================================
// 4. HOW TO CREATE A TURRET
// ============================================================================
//
// 1. Create a new prefab (e.g., "ArrowTower", "CannonTurret").
// 2. Add:
//
//      - Turret (sets teamID on components)
//      - Attackable
//      - UnitCombatController
//      - WeaponComponent
//
// 3. Remove NavMeshAgent (turrets do not move).
//
// 4. Assign a muzzle Transform for projectile spawn.
//
// 5. Set:
//      - weapon.range
//      - weapon.damage
//      - weapon.fireCooldown
//
// ============================================================================
// 5. COMPONENT RESPONSIBILITIES
// ============================================================================
//
// ---------------------------------------------------------------------------
// A. Attackable (MonoBehaviour)
// ---------------------------------------------------------------------------
// • Universal health + damage component.
// • Required by units, turrets, buildings, civilians.
// • Exposes:
//      int teamID
//      bool isCivilian
//      bool isBuilding
//      bool IsAlive
//      float CurrentHealth
//      float MaxHealth
//      void TakeDamage(float amount)
//      void Repair(float amount)
//      bool IsDamaged
//
// • Used by:
//      - UnitCombatController (target validation)
//      - WeaponComponent (damage application)
//      - Projectile (impact damage)
//      - AIMilitary (target bias)
//      - UnitInspectorUI (health display)
//      - AlertManager (attack notifications)
//
// • Notes:
//      - If adding armor/shields, modify TakeDamage().
//      - If adding death animations, replace Destroy() with animation events.
//      - If adding pooling, replace Destroy() with pool return.
//
// ---------------------------------------------------------------------------
// B. UnitCombatController
// ---------------------------------------------------------------------------
// • Handles:
//      - Target acquisition
//      - Stance logic (Hold, Guard, Aggressive)
//      - Manual targeting (AIMilitary or player)
//      - Rotating toward target
//      - Calling WeaponComponent.FireAtTarget()
//
// • Does NOT:
//      - Spawn projectiles
//      - Apply damage
//      - Handle cooldowns
//
// ---------------------------------------------------------------------------
// C. WeaponComponent
// ---------------------------------------------------------------------------
// • Handles:
//      - Fire cooldown
//      - Muzzle flash FX
//      - Projectile spawning via ProjectilePool
//
// • Requires:
//      - projectilePrefab
//      - muzzle Transform
//
// ---------------------------------------------------------------------------
// D. Projectile
// ---------------------------------------------------------------------------
// • Homing projectile that tracks a target.
// • Applies damage on impact.
// • Returns to pool via ProjectilePool.
//
// ---------------------------------------------------------------------------
// E. ProjectilePool
// ---------------------------------------------------------------------------
// • One instance in the scene.
// • Pools projectiles by prefab.
// • Prevents GC spikes from Instantiate/Destroy.
//
// ============================================================================
// 6. COMBAT FLOW SUMMARY
// ============================================================================
//
// 1. UnitCombatController searches for a valid target.
// 2. If target is in range:
//      - Unit rotates toward target.
//      - If WeaponComponent.CanFire:
//            WeaponComponent.FireAtTarget(target, teamID)
//
// 3. WeaponComponent:
//      - Spawns projectile via ProjectilePool
//      - Plays muzzle FX
//      - Starts cooldown timer
//
// 4. Projectile:
//      - Homes toward target
//      - On impact:
//            - Calls target.TakeDamage()
//            - Plays impact FX
//            - Returns to pool
//
// ============================================================================
// 7. LAYERS & TAGS REQUIRED
// ============================================================================
//
// • "Attackable" layer recommended for all Attackable objects.
// • UnitCombatController.attackableLayers must include this layer.
// • Civilians and buildings should also be Attackable.
//
// ============================================================================
// 8. COMMON PITFALLS & HOW TO AVOID THEM
// ============================================================================
//
// • Missing ProjectilePool in scene
//      ? Add a GameObject named "ProjectilePool" with the component.
//
// • WeaponComponent.muzzle not assigned
//      ? Projectiles spawn at (0,0,0).
//
// • Attackable missing on units/turrets
//      ? They cannot be targeted or damaged.
//
// • attackableLayers not set
//      ? Units never acquire targets.
//
// • projectilePrefab not assigned
//      ? WeaponComponent silently fails.
//
// ============================================================================
// 9. EXTENDING THE COMBAT SYSTEM
// ============================================================================
//
// You can safely add:
//
// • Melee weapons (no projectile)
// • Beam weapons (continuous damage)
// • AoE explosions
// • Armor/resistance system
// • Weapon upgrades (tech tree)
// • Multiple weapons per unit
//
// The modular design supports all of these.
//
// ============================================================================
// END OF DOCUMENT
// ============================================================================