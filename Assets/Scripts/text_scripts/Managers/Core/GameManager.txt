using UnityEngine;

/// <summary>
/// Central orchestrator for Cube Wars.
/// 
/// Responsibilities:
/// - Detect all teams in the scene
/// - Track player team and AI teams
/// - Provide global access to team data
/// - Handle win/loss conditions (later)
/// - Coordinate high-level game state
///
/// IMPORTANT:
/// This script does NOT spawn, delete, or modify teams.
/// It is intentionally non-destructive.
/// </summary>
public class GameManager : MonoBehaviour
{
    [Header("Teams (Auto-Detected)")]
    [Tooltip("All teams currently active in the scene.")]
    public Team[] allTeams;

    [Tooltip("The player-controlled team.")]
    public Team playerTeam;

    [Tooltip("All AI-controlled teams.")]
    public Team[] aiTeams;

    void Awake()
    {
        Debug.Log("GameManager initialized");

        DetectTeams();
    }

    /// <summary>
    /// Finds all Team components in the scene and categorizes them.
    /// </summary>
    private void DetectTeams()
    {
        allTeams = FindObjectsOfType<Team>();

        // Identify player team
        foreach (var team in allTeams)
        {
            if (team.teamType == TeamType.Player)
            {
                playerTeam = team;
                break;
            }
        }

        // Identify AI teams
        aiTeams = System.Array.FindAll(allTeams, t => t.teamType == TeamType.AI);

        Debug.Log($"Detected {allTeams.Length} teams. Player team: {playerTeam?.teamID}");
    }
}